#include <stdio.h>
#include <stdlib.h>
#include <math.h>

struct Borrower {
    float loan_amount;
    float interest_rate;
    int tenure;
    float monthly_income;
    float emi;
};

float calculateEMI(float loan, float rate, int months) {
    float r = rate / (12 * 100);
    return (loan * r * pow(1 + r, months)) / (pow(1 + r, months) - 1);
}

void amortizationSchedule(float loan, float rate, int months, float emi) {
    float balance = loan;
    float r = rate / (12 * 100);

    printf("\nMonth\tEMI\tInterest\tPrincipal\tBalance\n");
    for (int i = 1; i <= months; i++) {
        float interest = balance * r;
        float principal = emi - interest;
        balance -= principal;
        if (balance < 0) balance = 0;

        printf("%d\t%.2f\t%.2f\t\t%.2f\t\t%.2f\n",
               i, emi, interest, principal, balance);
    }
}

int main() {
    int n;
    struct Borrower *b;

    printf("Enter number of loan applications: ");
    scanf("%d", &n);

    b = (struct Borrower *)malloc(n * sizeof(struct Borrower));

    for (int i = 0; i < n; i++) {
        printf("\nApplication %d\n", i + 1);

        printf("Loan Amount: ");
        scanf("%f", &b[i].loan_amount);

        printf("Annual Interest Rate: ");
        scanf("%f", &b[i].interest_rate);

        printf("Tenure (months): ");
        scanf("%d", &b[i].tenure);

        printf("Monthly Income: ");
        scanf("%f", &b[i].monthly_income);

        if (b[i].loan_amount > 10 * b[i].monthly_income) {
            printf("Loan Not Eligible\n");
        } else {
            printf("Loan Eligible\n");
            b[i].emi = calculateEMI(
                b[i].loan_amount,
                b[i].interest_rate,
                b[i].tenure
            );
            printf("Monthly EMI: %.2f\n", b[i].emi);
            amortizationSchedule(
                b[i].loan_amount,
                b[i].interest_rate,
                b[i].tenure,
                b[i].emi
            );
        }
    }

    free(b);
    return 0;
}
